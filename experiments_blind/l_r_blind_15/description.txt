Размывал при помощи convolve2d mode=full
потмо
инициализировал h по-хитрому
при этом h делил на сумму каждый раз
использовал свои реализации конволюции